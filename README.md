2023.02  
2023년 2월 말, stable-diffusion 모델에 관심이 생겨 진행한 프로젝트다.  

AI 모델을 컴퓨터에서 직접 실행해보는 건 처음이라 실행 환경을 맞추느라 며칠 동안 애를 많이 먹었던 기억이 난다.  
결국 어떻게 성공해서 이런 그림을 그렸다.
<img width="2560" height="1272" alt="image" src="https://github.com/user-attachments/assets/ad5b6799-2266-494a-b392-1300336097ea" />  
<img width="512" height="512" alt="image" src="https://github.com/user-attachments/assets/8153c8e6-a919-470a-bcee-253a5a861bcc" />  

이후 'Stable Diffusion Model을 활용한 주가의 대략적 향방 예측'프로젝트를 잠깐 시도해봤다.  
아이디어는 다음과 같다.  
1. KOSPI200 종목 데이터를 불러와 일정한 window size로 나누고, 512*512 크기의 차트 이미지를 생성한다.
2. 이 이미지를 Stable-Diffusion 모델에 학습시킨다.
3. 현재 주가 데이터 차트를 모델에 학습시킨 차트의 형태와 같은 모양으로 만든다. 단, 예측 대상이 되는 1개월은 아무 차트 없이 비워놓는다.
4. Stable-Diffusion 모델에는 그림 혹은 사진의 빈 부분을 채우는 기능이 있다. 사전 학습된 Stable-Diffusion 모델에서 이 기능을 사용하여 예측 대상이 되는 부분을 채운다.
5. 채워진 부분은 모델이 예측한 향후 주가의 대략적 향방이라고 할 수 있다.  

물론 이걸 구현해서 실제 투자에 활용하기에는 상당히 불안하다. 나라면 안 쓸 거다..  
그저 패턴을 학습하여 그럴듯한 모양을 그려내는 것뿐이기에, 기복 신앙같은 느낌이 있다.  
그럼에도 이런 아이디어 자체가 재밌어 보였기에 구현해보고 싶었다.  

당시 모델 학습을 위해 주가 데이터를 차트 이미지로 저장하고, 같은 비율로 정규화하는 프로그램(DMPredict/savechart, InvokeAI-main/resize_512)을 작성했다.  
krx에서 KOSPI200에 속한 종목의 1년치 일별 종가 데이터를 크롤링하고 정규화해서 총 1413개의 이미지 파일을 확보했다(DMPredict/charts).

이 자료를 활용해 모델을 나름대로 파인튜닝해서 이미지를 뽑아 봤으나,  
<img width="512" height="512" alt="image" src="https://github.com/user-attachments/assets/cd0f2cea-6e93-488f-9ce1-f1a65846bf33" />  
나름 주가 비슷한 게 나오긴 했지만 썩 시원찮았다.

그 당시엔 이 정도로 만족하고 끝냈던 것 같다.  
더욱 파 보고 싶었으나, 3월 초부터 광주교육대학교 연구보조 아르바이트를 하게 되어 미뤄뒀었다.  
당시 AI모델을 직접 구현하는 것에는 전혀 지식이 없었다. 정말 많은 시행착오를 거쳤고 나 자신의 한계도 많이 체감했다. 모델을 깔았다 지웠다만 몇 번은 했던 것 같다.  
그래도 결과적으로 많은 공부가 됐고, 무엇보다 재미있었다. 이 경험이 없었다면 지금까지도 AI 구현에 자신이 없었을 것이다.  

이후 이 아이디어를 차용해서 DB금융경제공모전에 '현재 주가 차트를 이용한 과거 유사 차트 검색 시스템 제안'이라는 아이디어를 제출했고, 예선 통과했다.  
위의 기복 신앙같은 아이디어를 대형 증권사에서 하는 공모전에 내기에는 너무 장난스러워 보였다.  
그래서 주가를 예측하는 것 대신, 파인튜닝된 모델을 마치 Classification 모델처럼 활용하여 현재의 차트 데이터와 비슷하게 생긴 과거 데이터들을 도출하여 투자자에게 제공하는 서비스 아이디어를 구상해 봤다(DBRight 최인재_3.pdf). 
